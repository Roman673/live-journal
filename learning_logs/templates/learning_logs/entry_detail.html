{% extends 'base.html' %}
{% load bootstrap3 %}
{% load staticfiles %}

{% block title %}{{ entry }}{% endblock %}

{% block breadcrumb %}
  <div class="container">
    <ol class="breadcrumb">
      <li><a href="{% url 'learning_logs:index' %}">Home</a></li>
      <li><a href="{% url 'learning_logs:entries' %}">Articles</a></li>
      <li class="active">{{ entry }}</li>
    </ol>
  </div>
{% endblock %}

{% block content %}

  <div class="row">
    <div class="col-lg-7 col-lg-offset-2">
      
      <!-- Display author entry -->
      <div class="media">
        <div class="media-left">
          {% if avatar %}
            <img src="{{ avatar_url }}" class="media-object img-circle" height='50px' width="50px">
          {% else %}
            <img src="{% static 'img/avatar-tiny.jpg' %}" class="media-object img-circle" heigth="64">
          {% endif %}
        </div>
        <div class="media-body">
          <div class="media-heading">
            <h4>
              {{ entry.owner|title }}
              <div>
                <small>Pablished on {{ entry.date_added|date:'F d, Y' }}</small>
              </div>
            </h4>
          </div>
        </div>
      </div>

      <!-- Display title block -->
      <h1>
        {{ entry.title }}
        {% if user == entry.owner %}
          <a href="{% url 'learning_logs:entry_update' entry.slug %}" class="btn btn-default"><span class="glyphicon glyphicon-edit"></span></a>
          <a href="{% url 'learning_logs:entry_delete' entry.slug %}" class="btn btn-default"><span class="glyphicon glyphicon-trash"></span></a>
        {% endif %}
        <div>
          <small>
            {{ entry.views }} views
          </small>
        </div>
      </h1>

      <!-- Display image -->
      {% if entry.image %}
        <img src="{{ entry.image.url }}" alt="{{ entry.title }}" class="img-thumbnail" height='150'>
        <br>
      {% endif %}

      <br>

      <!-- Display entry text -->
      <p class="text-justify">{{ entry.text|linebreaksbr }}</p>

      <br>
      
      <div>
        <!-- Like button -->
        {% if user.is_authenticated %}
          <a href="{% url 'learning_logs:entry_like' entry.slug %}" class="btn btn-default"><span class="glyphicon glyphicon-thumbs-up"></span> Like | {{ entry.likes }}</a>
        {% endif %}
        <!-- Display tags -->
        {% for tag in tags %}
          <a href="{% url 'learning_logs:entry_tag' tag.slug %}" class="btn btn-{{ tag.color }} btn-sm">{{ tag.title }}</a>
        {% endfor %}
      </div>
      
      <br>

      <h4>Comments:</h4>
      
      <!-- Add new comments -->
      {% if user.is_authenticated %}
        <form action="{% url 'learning_logs:comment_create' entry.slug %}" method="post" class="form">
          {% csrf_token %}
          {% bootstrap_form form %}
          <input type="submit" class="btn btn-success" value="Post comment">
        </form>
      {% endif %}

      <!-- Display comments -->
      {% for comment in comments %}
        <div class="media">
          <div class="media-left">
            {% if comment.owner.person.image %}
              <img src="{{ comment.owner.person.image.url }}" class="media-object img-circle" height='50px' width="50px">
            {% else %}
              <img src="{% static 'img/avatar-tiny.jpg' %}" class="media-object img-circle">
            {% endif %}
          </div>
          <div class="media-body">
            <h4 class="media-heding">
              {{ comment.owner|title }}
              <small><i>Pablished on {{ comment.date_added|date:'F d, Y' }}</i></small>
              {% if comment.owner == user %}
                &nbsp;<a href="{% url 'learning_logs:comment_update' comment.pk %}" class="btn btn-default btn-xs"><span class="glyphicon glyphicon-edit"></span></a>
                <a href="{% url 'learning_logs:comment_delete' comment.pk %}" class="btn btn-default btn-xs"><span class="glyphicon glyphicon-trash"></span></a>
              {% endif %}
            </h4>
            <p>{{ comment.text|linebreaks }}</p>
          </div>
        </div>
      {% empty %}
        <div class="panel panel-default">
          <div class="panel-heading">No comments this entry yet.</div>
        </div>
      {% endfor %}

    </div>
  </div> <!-- end row -->

{% endblock %}
